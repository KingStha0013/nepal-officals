<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nepal Officials | Government App</title>
<style>
  *{margin:0;padding:0;box-sizing:border-box;}
  body{font-family:'Segoe UI',sans-serif; background:#f0f2f5; color:#222; transition:0.3s;}
  :root{
    --bg:#f0f2f5;
    --text:#222;
    --card-bg:#fff;
    --accent:#0055aa;
    --hover:#003366;
    --header-bg:#003366;
  }
  [data-theme="dark"]{
    --bg:#1a1a1a;
    --text:#eee;
    --card-bg:#2b2b2b;
    --accent:#0ff;
    --hover:#0a7fa0;
    --header-bg:#0a3d66;
  }
  body{background:var(--bg); color:var(--text);}

  /* Header */
  header{
    position: sticky;
    top:0;
    z-index:1000;
    padding:15px;
    background:var(--header-bg);
    color:#fff;
    text-align:center;
    display:flex;
    justify-content:center;
    align-items:center;
    gap:10px;
    flex-wrap:wrap;
    box-shadow:0 4px 10px rgba(0,0,0,0.2);
  }
  header img{height:50px;}
  header h1{
    font-size:24px; 
    font-weight:bold;
    text-transform:uppercase;
    letter-spacing:1px;
  }

  /* Controls */
  #controls{
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:10px;
    padding:15px;
    background:#e0e0e0;
  }
  [data-theme="dark"] #controls{background:#222;}
  #controls input{
    flex:1;
    padding:10px;
    border-radius:8px;
    border:1px solid #ccc;
    background:#fff;
    color:#222;
    font-size:16px;
  }
  [data-theme="dark"] #controls input{background:#2b2b2b; color:#eee; border:1px solid #444;}

  /* Small round toggle button */
  #controls button{
    width:40px;
    height:40px;
    border-radius:50%;
    font-size:18px;
    border:none;
    cursor:pointer;
    background:var(--accent);
    color:#fff;
    display:flex;
    align-items:center;
    justify-content:center;
    transition:0.3s;
  }
  #controls button:hover{background:var(--hover);}

  /* Loader */
  #loader{
    display:flex;
    justify-content:center;
    align-items:center;
    flex-direction:column;
    min-height:200px;
    transition:opacity 0.5s;
  }
  .spinner{
    border:6px solid #ccc;
    border-top:6px solid var(--accent);
    border-radius:50%;
    width:60px;
    height:60px;
    animation:spin 1s linear infinite;
    margin-bottom:15px;
  }
  @keyframes spin{100%{transform:rotate(360deg);}}
  .loader-text{font-size:18px;text-align:center;color:var(--accent);}

  /* App grid */
  #app{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(250px,1fr));
    gap:20px;
    padding:20px;
  }

  /* Card */
  .card{
    background:var(--card-bg);
    padding:20px;
    border-radius:10px;
    border-left:4px solid var(--accent);
    box-shadow:0 4px 10px rgba(0,0,0,0.1);
    transition:transform 0.2s, box-shadow 0.2s;
  }
  .card:hover{
    transform:translateY(-5px);
    box-shadow:0 6px 15px rgba(0,0,0,0.2);
  }
  .card h3{font-size:18px;color:var(--accent); margin-bottom:5px;}
  .card p{font-size:14px; color:#555; margin:3px 0;}
  [data-theme="dark"] .card p{color:#ccc;}

  /* Footer */
  footer{
    text-align:center;
    padding:12px;
    background:#e0e0e0;
    font-size:13px;
    color:#555;
  }
  [data-theme="dark"] footer{background:#222; color:#aaa;}

  /* Mobile */
  @media(max-width:480px){
    #controls{flex-direction:row;}
    #controls input{flex:1;}
    header h1{font-size:20px;}
  }
</style>
</head>
<body data-theme="light">

<header>
  <img src="https://upload.wikimedia.org/wikipedia/commons/9/9b/Flag_of_Nepal.svg" alt="Nepal Flag">
  <h1>Nepal Officials</h1>
</header>

<div id="controls">
  <input type="text" id="search" placeholder="Search officials...">
  <button id="themeBtn">üåô</button>
</div>

<div id="loader">
  <div class="spinner"></div>
  <div class="loader-text">Loading Officials...</div>
</div>

<div id="app" style="display:none;"></div>

<footer>Auto-refresh every 40s | David ¬©Ô∏è</footer>

<script>
const app = document.getElementById('app');
const loader = document.getElementById('loader');
const searchInput = document.getElementById('search');
const themeBtn = document.getElementById('themeBtn');

// Fetch and display officials
async function loadOfficials(){
  loader.style.opacity='1';
  loader.style.display='flex';
  app.style.display='none';
  try{
    const res = await fetch('https://raw.githubusercontent.com/KingStha0013/nepal-officals/main/officials.json?t='+Date.now());
    const data = await res.json();
    displayOfficials(data);
    loader.style.opacity='0';
    setTimeout(()=>loader.style.display='none',500);
    app.style.display='grid';
  }catch(err){
    loader.innerHTML='‚ùå Failed to load data';
    console.error(err);
  }
}

// Display filtered officials
function displayOfficials(data){
  const filter = searchInput.value.toLowerCase();
  app.innerHTML='';
  const filtered = data.filter(o=>o.name.toLowerCase().includes(filter) || o.position.toLowerCase().includes(filter));
  if(filtered.length===0){app.innerHTML='<p>No officials found.</p>'; return;}
  filtered.forEach(o=>{
    const card=document.createElement('div');
    card.className='card';
    card.innerHTML=`
      <h3>${o.name}</h3>
      <p><b>Position:</b> ${o.position}</p>
      <p><b>Ministry:</b> ${o.ministry}</p>
    `;
    app.appendChild(card);
  });
}

// Event listeners
searchInput.addEventListener('input', loadOfficials);
themeBtn.addEventListener('click', ()=>{
  if(document.body.dataset.theme==='dark'){
    document.body.dataset.theme='light';
    themeBtn.textContent='üåô';
  }else{
    document.body.dataset.theme='dark';
    themeBtn.textContent='‚òÄÔ∏è';
  }
});

// Auto-refresh every 40s
setInterval(loadOfficials,40000);

// Initial load
loadOfficials();
</script>
</body>
</html>